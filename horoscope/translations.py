LANGUAGE_NAMES = {
    'en': "English",
    'ru': "–†—É—Å—Å–∫–∏–π",
    'uk': "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞",
    'de': "Deutsch",
}

LANGUAGE_FLAGS = {
    'en': "üá¨üáß",
    'ru': "üá∑üá∫",
    'uk': "üá∫üá¶",
    'de': "üá©üá™",
}

TRANSLATIONS = {
    # --- Wizard: language selection ---
    "wizard.choose_language": {
        "en": "üåç Please choose your language:",
        "ru": "üåç –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:",
        "uk": "üåç –ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –º–æ–≤—É:",
        "de": "üåç Bitte w√§hlen Sie Ihre Sprache:",
    },

    # --- Wizard: start ---
    "wizard.welcome_back": {
        "en": "üëã Welcome back, <b>{name}</b>!\n\nYour profile is already set up. You'll receive your daily horoscope soon ‚ú®",
        "ru": "üëã –° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, <b>{name}</b>!\n\n–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –°–∫–æ—Ä–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø ‚ú®",
        "uk": "üëã –ó –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º, <b>{name}</b>!\n\n–í–∞—à –ø—Ä–æ—Ñ—ñ–ª—å –≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π. –°–∫–æ—Ä–æ –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ —â–æ–¥–µ–Ω–Ω–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø ‚ú®",
        "de": "üëã Willkommen zur√ºck, <b>{name}</b>!\n\nIhr Profil ist bereits eingerichtet. Sie erhalten bald Ihr t√§gliches Horoskop ‚ú®",
    },
    "wizard.welcome": {
        "en": "‚ú® Welcome to <b>Mystic Horoscope</b>! ‚ú®\n\nüîÆ I'll create a personalized horoscope just for you. Let's set up your profile first.\n\nWhat is your <b>name</b>?",
        "ru": "‚ú® –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <b>Mystic Horoscope</b>! ‚ú®\n\nüîÆ –Ø —Å–æ–∑–¥–∞–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å. –î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–∏–º –ø—Ä–æ—Ñ–∏–ª—å.\n\n–ö–∞–∫ –≤–∞—Å <b>–∑–æ–≤—É—Ç</b>?",
        "uk": "‚ú® –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ <b>Mystic Horoscope</b>! ‚ú®\n\nüîÆ –Ø —Å—Ç–≤–æ—Ä—é –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å. –°–ø–æ—á–∞—Ç–∫—É –Ω–∞–ª–∞—à—Ç—É—î–º–æ –ø—Ä–æ—Ñ—ñ–ª—å.\n\n–Ø–∫ –≤–∞—Å <b>–∑–≤–∞—Ç–∏</b>?",
        "de": "‚ú® Willkommen bei <b>Mystic Horoscope</b>! ‚ú®\n\nüîÆ Ich erstelle ein personalisiertes Horoskop nur f√ºr Sie. Lassen Sie uns zuerst Ihr Profil einrichten.\n\nWie ist Ihr <b>Name</b>?",
    },

    # --- Wizard: name step ---
    "wizard.invalid_name": {
        "en": "Please enter a valid name (2-100 characters).",
        "ru": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è (2-100 —Å–∏–º–≤–æ–ª–æ–≤).",
        "uk": "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–µ —ñ–º'—è (2-100 —Å–∏–º–≤–æ–ª—ñ–≤).",
        "de": "Bitte geben Sie einen g√ºltigen Namen ein (2-100 Zeichen).",
    },
    "wizard.ask_dob": {
        "en": "üòä Nice to meet you, <b>{name}</b>!\n\nüìÖ Now, please enter your <b>full date of birth</b>\nin format: <code>DD.MM.YYYY</code>\n\nExample: <code>15.03.1990</code>",
        "ru": "üòä –ü—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è, <b>{name}</b>!\n\nüìÖ –¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à—É <b>–ø–æ–ª–Ω—É—é –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è</b>\n–≤ —Ñ–æ—Ä–º–∞—Ç–µ: <code>–î–î.–ú–ú.–ì–ì–ì–ì</code>\n\n–ü—Ä–∏–º–µ—Ä: <code>15.03.1990</code>",
        "uk": "üòä –ü—Ä–∏—î–º–Ω–æ –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è, <b>{name}</b>!\n\nüìÖ –¢–µ–ø–µ—Ä –≤–≤–µ–¥—ñ—Ç—å –≤–∞—à—É <b>–ø–æ–≤–Ω—É –¥–∞—Ç—É –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</b>\n—É —Ñ–æ—Ä–º–∞—Ç—ñ: <code>–î–î.–ú–ú.–†–†–†–†</code>\n\n–ü—Ä–∏–∫–ª–∞–¥: <code>15.03.1990</code>",
        "de": "üòä Freut mich, <b>{name}</b>!\n\nüìÖ Bitte geben Sie Ihr <b>vollst√§ndiges Geburtsdatum</b> ein\nim Format: <code>TT.MM.JJJJ</code>\n\nBeispiel: <code>15.03.1990</code>",
    },

    # --- Wizard: DOB step ---
    "wizard.invalid_date_format": {
        "en": "Invalid date format. Please use <code>DD.MM.YYYY</code>\n\nExample: <code>15.03.1990</code>",
        "ru": "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>–î–î.–ú–ú.–ì–ì–ì–ì</code>\n\n–ü—Ä–∏–º–µ—Ä: <code>15.03.1990</code>",
        "uk": "–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ <code>–î–î.–ú–ú.–†–†–†–†</code>\n\n–ü—Ä–∏–∫–ª–∞–¥: <code>15.03.1990</code>",
        "de": "Ung√ºltiges Datumsformat. Bitte verwenden Sie <code>TT.MM.JJJJ</code>\n\nBeispiel: <code>15.03.1990</code>",
    },
    "wizard.dob_in_future": {
        "en": "Date of birth must be in the past. Please try again.",
        "ru": "–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –ø—Ä–æ—à–ª–æ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.",
        "uk": "–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –º–∞—î –±—É—Ç–∏ –≤ –º–∏–Ω—É–ª–æ–º—É. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.",
        "de": "Das Geburtsdatum muss in der Vergangenheit liegen. Bitte versuchen Sie es erneut.",
    },
    "wizard.dob_too_old": {
        "en": "Please enter a valid date of birth.",
        "ru": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è.",
        "uk": "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É –¥–∞—Ç—É –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è.",
        "de": "Bitte geben Sie ein g√ºltiges Geburtsdatum ein.",
    },

    # --- Wizard: place of birth step ---
    "wizard.ask_place_of_birth": {
        "en": "üéØ Great! Now, please enter your <b>place of birth</b> (city).\n\nExample: <code>London</code>",
        "ru": "üéØ –û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ <b>–º–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è</b> (–≥–æ—Ä–æ–¥).\n\n–ü—Ä–∏–º–µ—Ä: <code>–ú–æ—Å–∫–≤–∞</code>",
        "uk": "üéØ –ß—É–¥–æ–≤–æ! –¢–µ–ø–µ—Ä –≤–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ <b>–º—ñ—Å—Ü–µ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</b> (–º—ñ—Å—Ç–æ).\n\n–ü—Ä–∏–∫–ª–∞–¥: <code>–ö–∏—ó–≤</code>",
        "de": "üéØ Toll! Bitte geben Sie Ihren <b>Geburtsort</b> (Stadt) ein.\n\nBeispiel: <code>Berlin</code>",
    },
    "wizard.invalid_city": {
        "en": "Please enter a valid city name (2-200 characters).",
        "ru": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (2-200 —Å–∏–º–≤–æ–ª–æ–≤).",
        "uk": "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É –Ω–∞–∑–≤—É –º—ñ—Å—Ç–∞ (2-200 —Å–∏–º–≤–æ–ª—ñ–≤).",
        "de": "Bitte geben Sie einen g√ºltigen Stadtnamen ein (2-200 Zeichen).",
    },

    # --- Wizard: place of living step ---
    "wizard.ask_place_of_living": {
        "en": "üìç Almost done! Please enter your <b>current place of living</b> (city).\n\nExample: <code>New York</code>",
        "ru": "üìç –ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ! –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ <b>—Ç–µ–∫—É—â–µ–µ –º–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</b> (–≥–æ—Ä–æ–¥).\n\n–ü—Ä–∏–º–µ—Ä: <code>–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</code>",
        "uk": "üìç –ú–∞–π–∂–µ –≥–æ—Ç–æ–≤–æ! –í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ <b>–ø–æ—Ç–æ—á–Ω–µ –º—ñ—Å—Ü–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è</b> (–º—ñ—Å—Ç–æ).\n\n–ü—Ä–∏–∫–ª–∞–¥: <code>–õ—å–≤—ñ–≤</code>",
        "de": "üìç Fast fertig! Bitte geben Sie Ihren <b>aktuellen Wohnort</b> (Stadt) ein.\n\nBeispiel: <code>M√ºnchen</code>",
    },

    # --- Wizard: profile created ---
    "wizard.profile_ready": {
        "en": (
            "‚úÖ Your profile is ready, <b>{name}</b>!\n\n"
            "üìÖ Date of birth: {dob}\n"
            "üè† Born in: {place_of_birth}\n"
            "üìç Living in: {place_of_living}\n\n"
            "üîÆ Generating your first horoscope... Please wait a moment."
        ),
        "ru": (
            "‚úÖ –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å –≥–æ—Ç–æ–≤, <b>{name}</b>!\n\n"
            "üìÖ –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: {dob}\n"
            "üè† –ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è: {place_of_birth}\n"
            "üìç –ú–µ—Å—Ç–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è: {place_of_living}\n\n"
            "üîÆ –ì–µ–Ω–µ—Ä–∏—Ä—É—é –≤–∞—à –ø–µ—Ä–≤—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø... –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ."
        ),
        "uk": (
            "‚úÖ –í–∞—à –ø—Ä–æ—Ñ—ñ–ª—å –≥–æ—Ç–æ–≤–∏–π, <b>{name}</b>!\n\n"
            "üìÖ –î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: {dob}\n"
            "üè† –ú—ñ—Å—Ü–µ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: {place_of_birth}\n"
            "üìç –ú—ñ—Å—Ü–µ –ø—Ä–æ–∂–∏–≤–∞–Ω–Ω—è: {place_of_living}\n\n"
            "üîÆ –ì–µ–Ω–µ—Ä—É—é –≤–∞—à –ø–µ—Ä—à–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø... –ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞—á–µ–∫–∞–π—Ç–µ."
        ),
        "de": (
            "‚úÖ Ihr Profil ist fertig, <b>{name}</b>!\n\n"
            "üìÖ Geburtsdatum: {dob}\n"
            "üè† Geburtsort: {place_of_birth}\n"
            "üìç Wohnort: {place_of_living}\n\n"
            "üîÆ Ihr erstes Horoskop wird erstellt... Bitte warten Sie einen Moment."
        ),
    },

    # --- Horoscope view ---
    "horoscope.no_profile": {
        "en": "‚ö†Ô∏è You haven't set up your profile yet.\nSend /start to begin the onboarding wizard.",
        "ru": "‚ö†Ô∏è –í—ã –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å.\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –¥–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.",
        "uk": "‚ö†Ô∏è –í–∏ —â–µ –Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å.\n–ù–∞–¥—ñ—à–ª—ñ—Ç—å /start –¥–ª—è –ø–æ—á–∞—Ç–∫—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è.",
        "de": "‚ö†Ô∏è Sie haben Ihr Profil noch nicht eingerichtet.\nSenden Sie /start, um den Einrichtungsassistenten zu starten.",
    },
    "horoscope.not_ready": {
        "en": "‚è≥ Your horoscope for today is not ready yet.\nIt will be generated soon. Please check back later.",
        "ru": "‚è≥ –í–∞—à –≥–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤.\n–û–Ω —Å–∫–æ—Ä–æ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–∑–∂–µ.",
        "uk": "‚è≥ –í–∞—à –≥–æ—Ä–æ—Å–∫–æ–ø –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ —â–µ –Ω–µ –≥–æ—Ç–æ–≤–∏–π.\n–í—ñ–Ω —Å–∫–æ—Ä–æ –±—É–¥–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ.",
        "de": "‚è≥ Ihr Horoskop f√ºr heute ist noch nicht fertig.\nEs wird bald erstellt. Bitte schauen Sie sp√§ter noch einmal vorbei.",
    },
    "horoscope.subscribe_cta": {
        "en": "\n\nüîí Subscribe to see your full daily horoscope!",
        "ru": "\n\nüîí –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –ø–æ–ª–Ω—ã–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø!",
        "uk": "\n\nüîí –ü—ñ–¥–ø–∏—à—ñ—Ç—å—Å—è, —â–æ–± –±–∞—á–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —â–æ–¥–µ–Ω–Ω–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø!",
        "de": "\n\nüîí Abonnieren Sie, um Ihr vollst√§ndiges t√§gliches Horoskop zu sehen!",
    },

    # --- Subscription ---
    "subscription.offer": {
        "en": (
            "‚≠ê Subscribe for <b>{days} days</b> of full daily horoscope access.\n\n"
            "üí∞ Price: <b>{price} Telegram Stars</b>\n\n"
            "Tap the button below to pay."
        ),
        "ru": (
            "‚≠ê –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ <b>{days} –¥–Ω–µ–π</b> –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –≥–æ—Ä–æ—Å–∫–æ–ø—É.\n\n"
            "üí∞ –¶–µ–Ω–∞: <b>{price} Telegram Stars</b>\n\n"
            "–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã."
        ),
        "uk": (
            "‚≠ê –ü—ñ–¥–ø–∏—à—ñ—Ç—å—Å—è –Ω–∞ <b>{days} –¥–Ω—ñ–≤</b> –ø–æ–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ —â–æ–¥–µ–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ—Å–∫–æ–ø—É.\n\n"
            "üí∞ –¶—ñ–Ω–∞: <b>{price} Telegram Stars</b>\n\n"
            "–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ –¥–ª—è –æ–ø–ª–∞—Ç–∏."
        ),
        "de": (
            "‚≠ê Abonnieren Sie f√ºr <b>{days} Tage</b> vollen Zugang zum t√§glichen Horoskop.\n\n"
            "üí∞ Preis: <b>{price} Telegram Stars</b>\n\n"
            "Tippen Sie auf die Schaltfl√§che unten, um zu bezahlen."
        ),
    },
    "subscription.invoice_title": {
        "en": "Horoscope Subscription",
        "ru": "–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≥–æ—Ä–æ—Å–∫–æ–ø",
        "uk": "–ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≥–æ—Ä–æ—Å–∫–æ–ø",
        "de": "Horoskop-Abonnement",
    },
    "subscription.invoice_description": {
        "en": "{days}-day access to full daily horoscope",
        "ru": "–î–æ—Å—Ç—É–ø –∫ –ø–æ–ª–Ω–æ–º—É –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –≥–æ—Ä–æ—Å–∫–æ–ø—É –Ω–∞ {days} –¥–Ω–µ–π",
        "uk": "–î–æ—Å—Ç—É–ø –¥–æ –ø–æ–≤–Ω–æ–≥–æ —â–æ–¥–µ–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ—Å–∫–æ–ø—É –Ω–∞ {days} –¥–Ω—ñ–≤",
        "de": "{days}-t√§giger Zugang zum vollst√§ndigen t√§glichen Horoskop",
    },
    "subscription.payment_success": {
        "en": "‚úÖ Payment successful! Your subscription is now active.\n\nüìÖ Expires: {expires}\n\nUse /horoscope to see your full daily horoscope ‚ú®",
        "ru": "‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞.\n\nüìÖ –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: {expires}\n\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /horoscope –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–ª–Ω–æ–≥–æ –≥–æ—Ä–æ—Å–∫–æ–ø–∞ ‚ú®",
        "uk": "‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ–π—à–ª–∞ —É—Å–ø—ñ—à–Ω–æ! –í–∞—à—É –ø—ñ–¥–ø–∏—Å–∫—É –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.\n\nüìÖ –î—ñ–π—Å–Ω–∞ –¥–æ: {expires}\n\n–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ /horoscope –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ø–æ–≤–Ω–æ–≥–æ –≥–æ—Ä–æ—Å–∫–æ–ø—É ‚ú®",
        "de": "‚úÖ Zahlung erfolgreich! Ihr Abonnement ist jetzt aktiv.\n\nüìÖ G√ºltig bis: {expires}\n\nVerwenden Sie /horoscope, um Ihr vollst√§ndiges t√§gliches Horoskop zu sehen ‚ú®",
    },

    # --- Keyboard buttons ---
    "keyboard.subscribe": {
        "en": "‚≠ê Subscribe for full horoscope",
        "ru": "‚≠ê –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø–æ–ª–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø",
        "uk": "‚≠ê –ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ –ø–æ–≤–Ω–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø",
        "de": "‚≠ê F√ºr vollst√§ndiges Horoskop abonnieren",
    },

    # --- Celery tasks: first horoscope ---
    "task.first_horoscope_ready": {
        "en": "üîÆ Your first horoscope is ready!\n\n{text}",
        "ru": "üîÆ –í–∞—à –ø–µ—Ä–≤—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø –≥–æ—Ç–æ–≤!\n\n{text}",
        "uk": "üîÆ –í–∞—à –ø–µ—Ä—à–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø –≥–æ—Ç–æ–≤–∏–π!\n\n{text}",
        "de": "üîÆ Ihr erstes Horoskop ist fertig!\n\n{text}",
    },

    # --- Celery tasks: subscription reminders ---
    "task.expiry_reminder": {
        "en": "‚è∞ Your horoscope subscription expires in <b>{days} day(s)</b>.\n\nRenew now to keep receiving your full daily horoscope! ‚ú®",
        "ru": "‚è∞ –í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≥–æ—Ä–æ—Å–∫–æ–ø –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ <b>{days} –¥–Ω.</b>\n\n–ü—Ä–æ–¥–ª–∏—Ç–µ —Å–µ–π—á–∞—Å, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–ª—É—á–∞—Ç—å –ø–æ–ª–Ω—ã–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø! ‚ú®",
        "uk": "‚è∞ –í–∞—à–∞ –ø—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≥–æ—Ä–æ—Å–∫–æ–ø –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ <b>{days} –¥–Ω.</b>\n\n–ü–æ–Ω–æ–≤—ñ—Ç—å –∑–∞—Ä–∞–∑, —â–æ–± –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ–≤–Ω–∏–π —â–æ–¥–µ–Ω–Ω–∏–π –≥–æ—Ä–æ—Å–∫–æ–ø! ‚ú®",
        "de": "‚è∞ Ihr Horoskop-Abonnement l√§uft in <b>{days} Tag(en)</b> ab.\n\nVerl√§ngern Sie jetzt, um weiterhin Ihr vollst√§ndiges t√§gliches Horoskop zu erhalten! ‚ú®",
    },
    "task.subscription_expired": {
        "en": "‚ö†Ô∏è Your horoscope subscription has <b>expired</b>.\n\nYou'll now see a preview of your daily horoscope. Subscribe again to get full access! ‚≠ê",
        "ru": "‚ö†Ô∏è –í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≥–æ—Ä–æ—Å–∫–æ–ø <b>–∏—Å—Ç–µ–∫–ª–∞</b>.\n\n–¢–µ–ø–µ—Ä—å –≤—ã –≤–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–≤—å—é –≥–æ—Ä–æ—Å–∫–æ–ø–∞. –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å —Å–Ω–æ–≤–∞ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞! ‚≠ê",
        "uk": "‚ö†Ô∏è –í–∞—à–∞ –ø—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≥–æ—Ä–æ—Å–∫–æ–ø <b>–∑–∞–∫—ñ–Ω—á–∏–ª–∞—Å—è</b>.\n\n–¢–µ–ø–µ—Ä –≤–∏ –±–∞—á–∏—Ç–µ –ª–∏—à–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ –≥–æ—Ä–æ—Å–∫–æ–ø—É. –ü—ñ–¥–ø–∏—à—ñ—Ç—å—Å—è –∑–Ω–æ–≤—É –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É! ‚≠ê",
        "de": "‚ö†Ô∏è Ihr Horoskop-Abonnement ist <b>abgelaufen</b>.\n\nSie sehen jetzt nur eine Vorschau Ihres t√§glichen Horoskops. Abonnieren Sie erneut f√ºr vollen Zugang! ‚≠ê",
    },

    # --- Language command ---
    "language.current": {
        "en": "üåç Your current language: <b>{lang_name}</b>\n\nChoose a new language:",
        "ru": "üåç –í–∞—à —Ç–µ–∫—É—â–∏–π —è–∑—ã–∫: <b>{lang_name}</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π —è–∑—ã–∫:",
        "uk": "üåç –í–∞—à–∞ –ø–æ—Ç–æ—á–Ω–∞ –º–æ–≤–∞: <b>{lang_name}</b>\n\n–û–±–µ—Ä—ñ—Ç—å –Ω–æ–≤—É –º–æ–≤—É:",
        "de": "üåç Ihre aktuelle Sprache: <b>{lang_name}</b>\n\nW√§hlen Sie eine neue Sprache:",
    },
    "language.changed": {
        "en": "‚úÖ Language changed to <b>English</b> üá¨üáß",
        "ru": "‚úÖ –Ø–∑—ã–∫ –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ <b>–†—É—Å—Å–∫–∏–π</b> üá∑üá∫",
        "uk": "‚úÖ –ú–æ–≤—É –∑–º—ñ–Ω–µ–Ω–æ –Ω–∞ <b>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</b> üá∫üá¶",
        "de": "‚úÖ Sprache ge√§ndert zu <b>Deutsch</b> üá©üá™",
    },
    "language.no_profile": {
        "en": "‚ö†Ô∏è You haven't set up your profile yet.\nSend /start to begin.",
        "ru": "‚ö†Ô∏è –í—ã –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å.\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –¥–ª—è –Ω–∞—á–∞–ª–∞.",
        "uk": "‚ö†Ô∏è –í–∏ —â–µ –Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ –ø—Ä–æ—Ñ—ñ–ª—å.\n–ù–∞–¥—ñ—à–ª—ñ—Ç—å /start –¥–ª—è –ø–æ—á–∞—Ç–∫—É.",
        "de": "‚ö†Ô∏è Sie haben Ihr Profil noch nicht eingerichtet.\nSenden Sie /start, um zu beginnen.",
    },

    # --- Horoscope template phrases ---
    "horoscope.header": {
        "en": "Horoscope for {sign} ‚Äî {date}",
        "ru": "–ì–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è {sign} ‚Äî {date}",
        "uk": "–ì–æ—Ä–æ—Å–∫–æ–ø –¥–ª—è {sign} ‚Äî {date}",
        "de": "Horoskop f√ºr {sign} ‚Äî {date}",
    },
    "horoscope.greeting": {
        "en": "Dear {name},",
        "ru": "–î–æ—Ä–æ–≥–æ–π(–∞—è) {name},",
        "uk": "–î–æ—Ä–æ–≥–∏–π(–∞) {name},",
        "de": "Liebe(r) {name},",
    },
}


def t(key: str, language: str, **kwargs) -> str:
    """Get translated string by key and language code, with optional formatting."""
    entry = TRANSLATIONS.get(key)
    if not entry:
        return key

    text = entry.get(language) or entry.get('en', key)

    if kwargs:
        text = text.format(**kwargs)

    return text


SUPPORTED_LANGUAGE_CODES = {'en', 'ru', 'uk', 'de'}


def map_telegram_language(language_code: str | None) -> str:
    """Map Telegram's language_code to our supported language code."""
    if not language_code:
        return 'en'
    code = language_code.lower().split('-')[0]
    if code in SUPPORTED_LANGUAGE_CODES:
        return code
    return 'en'
